name: GLaaS-SRV-REC
namespace: com.citrix.adc.stylebooks
version: "1.1"
display-name: "SRV REC Config for GLaaS"
description: "This StyleBook defines the SRV record DNS Config  ...."
schema-version: "1.0"
import-stylebooks: 
  - 
    namespace: netscaler.nitro.config
    prefix: ns
    version: "10.5"
  - 
    namespace: "com.citrix.adc.stylebooks"
    prefix: "stlb"
    version: "1.1"

parameters:
  -
    name: customer-name
    label: "Customer Name"
    description: "Name of customer owning the config"
    type: string
    key: true
    required: true
    updatable: false
  - 
    name: domain-name
    label: "Domain Name of the app "
    description: "Domain Name that is associated with the app"
    type: string
    key: true
    required: true
    updatable: true  
  -  
    name: ttl
    label: "TTL for the Domain"
    description: "TTL for the domain in seconds"
    type: number
    default: 30
    required: true
    updatable: true   
  -
    name: srv-rec-prop
    label: "Domain properties"
    description: "SRV Rec and TTL"
    type: object[]
    required: true
    updatable: true
    parameters:  
      - 
        name: srv-target
        label: "Host name of the target "
        description: "Host name of the target"
        type: string
        required: true
        updatable: false
      -  
        name: prio
        label: "Priority"
        description: "Priority of the target host"
        type: number
        required: true
        updatable: true 
      -  
        name: weight
        label: "Weight "
        description: "Weight for the target host"
        type: number
        required: true
        updatable: true   
      - 
        name: srv-port
        label: "Port"
        description: "Port on which the target host listens for client requests."
        type: tcp-port
        required: true
        updatable: true
        default: 53       

components: 
  - 
    name: srv_records
    type: ns::dnssrvrec
    repeat: $parameters.srv-rec-prop
    repeat-item: srv-rec
    properties:
      domain: $parameters.domain-name
      target: $srv-rec.srv-target
      ttl: $parameters.ttl
      priority: $srv-rec.prio
      port: $srv-rec.srv-port
      weight: $srv-rec.weight
 
outputs:
  -
    name: srvRecord
    value: $components.srv_records